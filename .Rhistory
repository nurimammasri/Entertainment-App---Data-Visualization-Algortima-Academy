spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
names(spotify)
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
names(spotify)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
arrange(desc(spotify_clean$year))
spotify_clean
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date, "-01-01"), release_date)) %>%
arrange(desc(spotify_clean$year))
spotify_clean
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
arrange(desc(spotify_clean$year))
spotify_clean
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
names(spotify)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
names(spotify)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
mutate(release_date = ymd(release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
spotify_genre <- read_csv("datasets/data_by_genres.csv")
spotify_genre <- read_csv("datasets/data_by_genres.csv")
spotify_genre
names(spotify)
names(spotify_genre)
x <- names(spotify)
y <- names(spotify_genre)
x[!(x %in% y)]
y <- names(spotify)
x <- names(spotify_genre)
x[!(x %in% y)]
x <- names(spotify)
y <- names(spotify_genre)
x[!(x %in% y)]
names(spotify_genre)
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
mutate(release_date = ymd(release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
spotify_genre <- read_csv("datasets/data_by_genres.csv")
glimpse(spotify_genre)
fct_cols <- c("mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("duration_ms", "key", "popularity")
spotify_genre_clean <- spotify_genre %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
arrange(spotify_clean$year)
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
mutate(release_date = ymd(release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
spotify_genre <- read_csv("datasets/data_by_genres.csv", show_col_types = FALSE)
glimpse(spotify_genre)
fct_cols <- c("mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("duration_ms", "key", "popularity")
spotify_genre_clean <- spotify_genre %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer))
spotify_genre_clean
setwd("D:/Data Science - Analyst/Algoritma Data Science School/DV bckp/5. Data Visualization Capstone Project/entertainment_app")
shiny::runApp()
runApp()
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
mutate(release_date = ymd(release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
spotify_genre <- read_csv("datasets/data_by_genres.csv", show_col_types = FALSE)
glimpse(spotify_genre)
fct_cols <- c("mode", "genre")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("duration_ms", "key", "popularity")
spotify_genre_clean <- spotify_genre %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer))
fct_cols <- c("mode", "genres")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("duration_ms", "key", "popularity")
spotify_genre_clean <- spotify_genre %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer))
spotify_genre_clean
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
mutate(release_date = ymd(release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
spotify_genre <- read_csv("datasets/data_by_genres.csv", show_col_types = FALSE)
glimpse(spotify_genre)
fct_cols <- c("mode", "genres")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("duration_ms", "key", "popularity")
spotify_genre_clean <- spotify_genre %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer))
spotify_genre_clean
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(all_of(fct_cols), as.factor)) %>%
mutate(across(all_of(num_cols), as.numeric)) %>%
mutate(across(all_of(int_cols), as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
mutate(release_date = as.Date(release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(all_of(fct_cols), as.factor)) %>%
mutate(across(all_of(num_cols), as.numeric)) %>%
mutate(across(all_of(int_cols), as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
mutate(release_date = as.Date(release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
spotify_genre <- read_csv("datasets/data_by_genres.csv", show_col_types = FALSE)
glimpse(spotify_genre)
fct_cols <- c("mode", "genres")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("duration_ms", "key", "popularity")
spotify_genre_clean <- spotify_genre %>%
mutate(across(fct_cols, as.factor)) %>%
mutate(across(num_cols, as.numeric)) %>%
mutate(across(int_cols, as.integer))
spotify_genre_clean
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(all_of(fct_cols), as.factor)) %>%
mutate(across(all_of(num_cols), as.numeric)) %>%
mutate(across(all_of(int_cols), as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
mutate(release_date = as.Date(release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
spotify_genre <- read_csv("datasets/data_by_genres.csv", show_col_types = FALSE)
glimpse(spotify_genre)
fct_cols <- c("mode", "genres")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("duration_ms", "key", "popularity")
spotify_genre_clean <- spotify_genre %>%
mutate(across(all_of(fct_cols), as.factor)) %>%
mutate(across(all_of(num_cols), as.numeric)) %>%
mutate(across(all_of(int_cols), as.integer))
spotify_genre_clean
shiny::runApp()
spotify_by_year
spotify_by_year <- spotify_clean %>%
group_by(year) %>%
summarise(across(c(-artists, -duration_ms, -explicit, -mode, -name, -release_date, -tempo, -id, -loudness, -popularity), mean, na.rm = TRUE))
spotify_by_year
spotify_by_year <- spotify_clean %>%
group_by(year) %>%
summarise(across(c(-artists, -duration_ms, -explicit, -mode, -name, -release_date, -tempo, -id, -loudness, -popularity), mean, na.rm = TRUE))
spotify_by_year
spotify_by_year <- spotify_clean %>%
group_by(year) %>%
summarise(-c(artists, duration_ms, explicit, mode, name, release_date, tempo, id, loudness, popularity), mean, na.rm = TRUE))
spotify_by_year <- spotify_clean %>%
group_by(year) %>%
summarise(-c(artists, duration_ms, explicit, mode, name, release_date, tempo, id, loudness, popularity), mean, na.rm = TRUE)
runApp()
runApp()
runApp()
data_agg1 <- spotify_by_year %>%
select(-key) %>%
gather(key = "Variable", value = "Value", - year)
# Import Library Visualization
library(tidyverse)
library(ggplot2)
library(dplyr) # untuk transformasi data
library(plotly) # untuk membuat plot menjadi interaktif
library(glue) # untuk custom informasi saat plot interaktif
library(scales) # untuk custom keterangan axis atau lainnya
library(tidyr) # untuk custom keterangan axis atau lainnya
library(stringr)# untuk melakuan kustom teks pada tooltip
library(wordcloud2)
library(readr)
spotify <- read_csv("datasets/data.csv", show_col_types = FALSE)
spotify$artists <- str_replace_all(spotify$artists, c("\\[" = "", "\\]" = "", "'"=""))
glimpse(spotify)
chr_cols <- c("artists", "name", "id", "release_date")
fct_cols <- c("explicit", "mode")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("year", "duration_ms", "key", "popularity")
spotify_clean <- spotify %>%
mutate(across(all_of(fct_cols), as.factor)) %>%
mutate(across(all_of(num_cols), as.numeric)) %>%
mutate(across(all_of(int_cols), as.integer)) %>%
mutate(release_date = ifelse(nchar(release_date) == 4, paste(release_date,"-01-01", sep=""), release_date)) %>%
mutate(release_date = as.Date(release_date)) %>%
arrange(spotify_clean$year)
spotify_clean
spotify_genre <- read_csv("datasets/data_by_genres.csv", show_col_types = FALSE)
glimpse(spotify_genre)
fct_cols <- c("mode", "genres")
num_cols <- c("valence", "acousticness", "danceability", "energy", "instrumentalness", "liveness", "loudness", "speechiness", "tempo")
int_cols <- c("duration_ms", "key", "popularity")
spotify_genre_clean <- spotify_genre %>%
mutate(across(all_of(fct_cols), as.factor)) %>%
mutate(across(all_of(num_cols), as.numeric)) %>%
mutate(across(all_of(int_cols), as.integer))
spotify_genre_clean
data_agg1 <- spotify_by_year %>%
select(-key) %>%
gather(key = "Variable", value = "Value", - year)
data_agg1
runApp()
spotify_by_year <- spotify_clean %>%
group_by(year) %>%
summarise(across(c(-artists, -duration_ms, -explicit, -mode, -name, -release_date, -tempo, -id, -loudness, -popularity), mean, na.rm = TRUE))
spotify_by_year
spotify_by_year <- spotify_clean %>%
group_by(year) %>%
summarise(across(c(-artists, -duration_ms, -explicit, -mode, -name, -release_date, -tempo, -id, -loudness, -popularity), mean, na.rm = TRUE))
data_agg1 <- spotify_by_year %>%
select(-key) %>%
gather(key = "Variable", value = "Value", - year)
plot1<- ggplot(data_agg1, aes(x = year, y = Value)) +
geom_line(aes(color = Variable))  +
guides(scale = "none") +
labs(x = "Year", y = "Value", title = "Preference Music Taste in the Past Century on Spotify") +
scale_x_continuous(limits = c(1921, 2020), breaks = seq(1921, 2020, 10)) +
theme_minimal()
ggplotly(plot1)
spotify_by_year <- spotify_clean %>%
group_by(year) %>%
summarise(across(c(-artists, -duration_ms, -explicit, -mode, -name, -release_date, -tempo, -id, -loudness, -popularity), mean, na.rm = TRUE))
data_agg1 <- spotify_by_year %>%
select(-key) %>%
gather(key = "Variable", value = "Value", - year)
ggplot(data_agg1, aes(x = year, y = Value)) +
geom_line(aes(color = Variable))  +
guides(scale = "none") +
labs(x = "Year", y = "Value", title = "Preference Music Taste in the Past Century on Spotify") +
scale_x_continuous(limits = c(1921, 2020), breaks = seq(1921, 2020, 10)) +
theme_minimal()
spotify_by_year <- spotify_clean %>%
group_by(year) %>%
summarise(across(c(-artists, -duration_ms, -explicit, -mode, -name, -release_date, -tempo, -id, -loudness, -popularity), mean, na.rm = TRUE))
data_agg1 <- spotify_by_year %>%
select(-key) %>%
gather(key = "Variable", value = "Value", - year)
plot1 <- ggplot(data_agg1, aes(x = year, y = Value)) +
geom_line(aes(color = Variable))  +
guides(scale = "none") +
labs(x = "Year", y = "Value", title = "Preference Music Taste in the Past Century on Spotify") +
scale_x_continuous(limits = c(1921, 2020), breaks = seq(1921, 2020, 10)) +
theme_minimal()
ggplotly(plot1)
spotify_by_year <- spotify_clean %>%
group_by(year) %>%
summarise(across(c(-artists, -duration_ms, -explicit, -mode, -name, -release_date, -tempo, -id, -loudness, -popularity), mean, na.rm = TRUE))
data_agg1 <- spotify_by_year %>%
select(-key) %>%
gather(key = "Variable", value = "Value", - year)
plot1 <- ggplot(data_agg1, aes(x = year, y = Value)) +
geom_line(aes(color = Variable))  +
scale_color_manual(values = c("red", "green", "orange", "purple")) +
guides(color = FALSE) +
labs(x = "Year", y = "Value", title = "Preference Music Taste in the Past Century on Spotify") +
scale_x_continuous(limits = c(1921, 2020), breaks = seq(1921, 2020, 10)) +
theme_minimal()
ggplotly(plot1)
spotify_by_year <- spotify_clean %>%
group_by(year) %>%
summarise(across(c(-artists, -duration_ms, -explicit, -mode, -name, -release_date, -tempo, -id, -loudness, -popularity), mean, na.rm = TRUE))
data_agg1 <- spotify_by_year %>%
select(-key) %>%
gather(key = "Variable", value = "Value", - year)
plot1 <- ggplot(data_agg1, aes(x = year, y = Value)) +
geom_line(aes(color = Variable))  +
scale_color_manual(values = c("red", "green", "orange", "purple", "blue", "black", "darkgreen")) +
guides(color = FALSE) +
labs(x = "Year", y = "Value", title = "Preference Music Taste in the Past Century on Spotify") +
scale_x_continuous(limits = c(1921, 2020), breaks = seq(1921, 2020, 10)) +
theme_minimal()
ggplotly(plot1)
